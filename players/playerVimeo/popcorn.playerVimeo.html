<!DOCTYPE html>
<html>
    <head>
        <title>Popcorn Vimeo Player Example</title>
        <style>
            iframe{
                display:block;
                border:0;
            }
            body > div {
                width: 100%;
                float: left;
                overflow: hidden;
            }
            div div {
                margin-bottom:20px;
            }

            .api_output {
                float:right;
                padding-left: 20px;
            }
        </style>
        
        <script src="./froogaloop.min.js"></script>
        
        <script src="../../popcorn.js"></script>
        <script type="text/javascript" src="popcorn.playerVimeo.js"></script>
        <script src="../../plugins/footnote/popcorn.footnote.js"></script>
        
        <script type="text/javascript">
            // Called as onload function
            VimeoEmbedLoaded = function( player )
            {
                var loop = 0,
                    volume = 1,
                    rPopPlay = /[\?&]popcornplay(=1)?/i;
                    
                var popped = Popcorn("#"+player.id)
                      .footnote({
                        start: 5, // seconds
                        end: 40, // seconds
                        text: 'The video is "RiP: A Rremix Manifesto", by Brett Gaylor',
                        target: 'footnotediv'
                      } );
                
                // Hook up custsom controls
                // Single play/pause button
                document.getElementById("btnPlayPause").addEventListener("click", function(e) {
                  if ( player.paused ) {
                    player.play();
                  } else {
                    player.pause();
                  }
                }, false);
                
                //Seek
                document.getElementById("btnSeek").addEventListener("click", function() {
                  player.setCurrentTime( 30 );
                }, false);

                // Loop
                document.getElementById("btnLoop").addEventListener("click", function() {
                  loop = loop === "loop" ? "" : "loop";
                  player.setLoop(loop);
                }, false);

                // Volume
                document.getElementById("btnVolume").addEventListener("click", function() {
                  volume = volume === 1 ? 0.5 : 1;
                  player.setVolume(volume);
                }, false);
                
                // Unload
                document.getElementById("btnUnload").addEventListener("click", function() {
                  player.unload();
                }, false);
                
                // Mute
                document.getElementById("btnMute").addEventListener("click", function() {
                  player.setVolume(0);
                }, false);
                
                // Hook into player events
                player.addEventListener( "timeupdate", function() {
                  document.getElementById( "player_time" ).innerHTML = player.currentTime;
                }, false);
                
                player.addEventListener( "playing", function() {
                  document.getElementById("btnPlayPause").innerHTML = "Pause";
                }, false);
                
                player.addEventListener( "pause", function() {
                  document.getElementById("btnPlayPause").innerHTML = "Play";
                }, false);
                
                // Hook into custom events
                player.addEventListener( "volumechange", function() {
                  document.getElementById("player_vol").innerHTML = player.volume;
                  document.getElementById("player_muted").innerHTML = player.muted;
                }, false);
                
                player.addEventListener( "durationchange", function() {
                  document.getElementById("player_duration").innerHTML = player.duration;
                }, false);
                
                player.addEventListener( "readystatechange", function() {
                  document.getElementById("player_state").innerHTML = player.readyState;
                }, false);
                
                if ( rPopPlay.test(location.search) ) {
                  popped.play();
                }
            };

            //On document ready
            document.addEventListener("DOMContentLoaded", function() {
              var rAutoplay = /[\?&]autoplay(=1)?/i,
                  player = new Popcorn.VimeoEngine(  "player_1", "http://vimeo.com/11127501" );
                
              player.addEventListener( "load", function() {
                VimeoEmbedLoaded( this );
              }, false );
              
              document.getElementById("player_state").innerHTML = player.readyState;
              document.getElementById("player_time").innerHTML = player.currentTime;
              document.getElementById("player_vol").innerHTML = player.volume;
              document.getElementById("player_muted").innerHTML = player.muted;
              
              // Autoplay attribute must be set before load event is fired
              if ( rAutoplay.test( location.search ) ) {
                player.autoplay = 1;
              }
            }, false);
        </script>
    </head>
    <body>
        <div>
          <iframe id="player_1" width="500" height="281" frameborder="0"></iframe>
          <button class="simple" id="btnPlayPause">Play</button>
          <button class="seek" id="btnSeek">Seek to 30</button>
          <button class="loop" id="btnLoop">Toggle Loop</button>
          <button class="volume" id="btnVolume">Toggle Volume</button>
          <button class="volume" id="btnMute">Mute</button>
          <button class="simple" id="btnUnload">Unload</button>
          <div>
            Current Time (s): <span id="player_time"></span>
            <br />Video Duration (s): <span id="player_duration"></span>
            <br />Ready State: <span id="player_state"></span>
            <br />Volume (0-1): <span id="player_vol"></span>
            <br />Muted: <span id="player_muted"></span>
          </div>
          <div id="footnotediv" width="50%" height="50%"> </div>
        </div>
        
        <div>
          <h3>Description</h3>
          <p>
            This demo will showcase how a Vimeo flash video can be integrated into Popcorn. This  is done by making the flash video masquerade as HTML 5 video.<br />
            Due to the Flash security model, this demo must be  run from a web server<br />
            From 5 to 40 seconds, the footnote 'The video is "RiP: A Rremix Manifesto", by Brett Gaylor' will appear above the description.
          <hr >
            Vimeo will not allow their player to be chromeless (hidden controls), but custsom controls have been developed and tied into theirs.<br />
            Clicking play/pause or seeking in either the video or via custsom controls will cause the other to update.<br />
            Clicking on the embed option in the Vimeo player while the video is playing will cause the video to pause and custom controls to update.<br />
            Click the links below to have Popcorn play the video automaticaally or have the video play itself.<br />
            The vimeo video can be specified in the HTML source by giving the vimeo web site url (http://vimeo.com/VIDEOID) to either the VimeoEngine or as the iframe src attribute.<br/>
          </p>
          <strong>Autoplay Options</strong>
          <ul>
            <li><a href="?autoplay">Have the video play itself automatically</a></li>
            <li><a href="?popcornplay">Have Popcorn play the video automatically</a></li>
            <li><a href="?">Do not autoplay</a></li>
          </ul>
        </div>
        
    </body>
</html>